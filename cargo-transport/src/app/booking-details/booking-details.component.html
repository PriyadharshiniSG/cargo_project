<app-adminnav></app-adminnav>
<div class="container">
  <form [formGroup]="statusForm" (ngSubmit)="filter(this.statusForm.value)">
    <label>Click to Filter details by Status</label>
    <select formControlName="stats" class="form-control" name="statusvalue">
      <option value="All">All</option>
      <option value="open">Open</option>
      <option value="Booking Accepted">Booking Accepted</option>
      <option value="Shipment Processing">Ready to Ship</option>
      <option value="Out for delivery">Finish Delivery</option>
      <option value="Reached your Destination">Delivered</option>
    </select>
    <button>Search</button>
  </form>
  <table class="table table-striped table-bordered border-primary" id="table">
    <caption>
      Customer Booking Details
    </caption>
    <thead class="bg-light">
      <tr>
        <th>Departure Place</th>
        <th>Destination Place</th>
        <th>Customer Name</th>
        <th>Email id</th>
        <th>Phone number</th>
        <th>Booking Status</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of obj1">
        <td>
          {{ item.departure["location"] }}
        </td>
        <td>
          {{ item.destination["location"] }}
        </td>
        <td>
          {{ item.fullName }}
        </td>
        <td>
          {{ item.email }}
        </td>
        <td>
          {{ item.phonenumber }}
        </td>
        <td>
          {{ item.status }}
        </td>
        <td>
          <button
            *ngIf="item.status !== 'Booking Accepted' && item.status === 'open'"
            style="background-color: #e65f5c; color: azure"
            class="btn btn-secondary"
            type="submit"
            (click)="onAccept(item._id, item._rev, 'Booking Accepted')"
          >
            Accept Request
          </button>
          <button
            *ngIf="
              item.status === 'Booking Accepted' &&
              item.status !== 'Shipment Processing'
            "
            class="btn btn-secondary"
            style="background-color: #ffff82"
            type="submit"
            (click)="onAccept(item._id, item._rev, 'Shipment Processing')"
          >
            Ready To ship
          </button>
          <button
            *ngIf="
              item.status === 'Shipment Processing' &&
              item.status !== 'Out for delivery'
            "
            class="btn btn-secondary"
            style="background-color: #ec612f"
            type="submit"
            (click)="onAccept(item._id, item._rev, 'Out for delivery')"
          >
            Move to Delivery
          </button>
          <button
            *ngIf="
              item.status === 'Out for delivery' &&
              item.status !== 'Reached your Destination'
            "
            class="btn btn-secondary"
            style="background-color: #ec2f2f"
            type="submit"
            (click)="onAccept(item._id, item._rev, 'Reached your Destination')"
          >
            Finish Delivery
          </button>
          <button
            *ngIf="item.status === 'Reached your Destination'"
            class="btn btn-secondary"
            style="background-color: #1ca70f"
            type="submit"
          >
            Delivered
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
